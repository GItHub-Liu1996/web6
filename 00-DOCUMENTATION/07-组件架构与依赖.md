# GoChinaAdvisors (仮) 组件架构与依赖关系

## 📋 概述

本文档详细记录了GoChinaAdvisors (仮)项目的组件架构设计、依赖关系和使用指南。项目严格按照解决方案驱动、移动端优先、转化漏斗设计的核心哲学构建，采用高度可复用的组件架构。

## 🎯 组件设计原则

### 1. **单一职责原则**
每个组件只负责一个功能，避免功能耦合。

### 2. **高度可复用**
UI轮子组件应该可以在任何地方使用，不依赖特定业务逻辑。

### 3. **低耦合**
组件之间尽量减少依赖关系，通过Props传递数据。

### 4. **组合优于继承**
通过组合简单组件构建复杂功能，而不是创建复杂的"万能组件"。

### 5. **移动端优先**
所有组件都支持响应式设计，确保移动端体验。

## 🏗️ 组件架构层次

### **组件分类与可复用性**

```
src/components/
├── ui/                    # 基础UI轮子组件 (高度可复用)
│   ├── Button.tsx         # 按钮组件 ✅
│   ├── Input.tsx          # 输入框组件 ✅
│   ├── Card.tsx           # 卡片组件 ✅
│   ├── Badge.tsx          # 徽章组件 ✅
│   ├── Separator.tsx      # 分割线组件 ✅
│   ├── Modal.tsx          # 模态框组件 (规划中)
│   ├── Toast.tsx          # 消息提示组件 (规划中)
│   ├── Loading.tsx        # 加载组件 (规划中)
│   ├── Avatar.tsx         # 头像组件 (规划中)
│   └── __tests__/         # 组件测试
├── layout/                 # 布局组件 (中等可复用)
│   ├── Container.tsx      # 响应式容器 ✅
│   ├── Grid.tsx           # 网格布局 ✅
│   ├── Stack.tsx          # 堆叠布局 ✅
│   ├── Header.tsx         # 页面头部 (特定用途) ✅
│   ├── Footer.tsx         # 页面底部 (特定用途) ✅
│   ├── Navigation.tsx     # 主导航 (特定用途) ✅
│   └── MegaMenu.tsx       # 超级菜单 (特定用途) ✅
├── content/                # 内容展示组件 (中等可复用)
│   ├── BlogCard.tsx       # 博客卡片 ✅
│   ├── CaseStudyCard.tsx  # 案例卡片 ✅
│   ├── ServiceCard.tsx    # 服务卡片 (规划中)
│   ├── TestimonialCard.tsx # 客户评价 (规划中)
│   └── FAQCard.tsx        # FAQ卡片 (规划中)
└── business/               # 业务特定组件 (低可复用)
    ├── ContactForm.tsx    # 联系表单 ✅
    ├── SolutionPackageCard.tsx # 解决方案卡片 ✅
    ├── PricingCard.tsx    # 价格卡片 (规划中)
    └── IndustryCard.tsx   # 行业卡片 (规划中)
```

## 🔧 UI轮子组件详细记录

### 1. **Button 组件**
**文件位置**: `src/components/ui/Button.tsx`

**依赖关系**:
- **直接依赖**: 
  - `React.forwardRef` - React核心
  - `cn` - 来自 `@/lib/utils`
- **使用工具函数**: 
  - `cn()` - 类名合并
- **使用常量**: 无
- **测试文件**: `Button.test.tsx` ✅
- **Storybook**: 规划中

**Props接口**:
```typescript
interface ButtonProps {
  variant?: 'default' | 'destructive' | 'outline' | 'secondary' | 'ghost' | 'link';
  size?: 'default' | 'sm' | 'lg' | 'icon';
  disabled?: boolean;
  loading?: boolean;
  children: React.ReactNode;
  onClick?: () => void;
  className?: string;
}
```

**功能特点**:
- 多种变体样式 (default, destructive, outline, secondary, ghost, link)
- 多种尺寸 (default, sm, lg, icon)
- 加载状态支持
- 无障碍设计
- 高度可复用

### 2. **Input 组件**
**文件位置**: `src/components/ui/Input.tsx`

**依赖关系**:
- **直接依赖**: 
  - `React.forwardRef` - React核心
  - `cn` - 来自 `@/lib/utils`
- **使用工具函数**: 
  - `cn()` - 类名合并
- **使用常量**: 无
- **测试文件**: 规划中
- **Storybook**: 规划中

**Props接口**:
```typescript
interface InputProps {
  type?: 'text' | 'email' | 'password' | 'tel' | 'url';
  placeholder?: string;
  value?: string;
  onChange?: (value: string) => void;
  error?: string;
  label?: string;
  helpText?: string;
  disabled?: boolean;
  required?: boolean;
  className?: string;
}
```

**功能特点**:
- 多种输入类型
- 错误状态显示
- 标签和帮助文本
- 验证支持
- 高度可复用

### 3. **Card 组件**
**文件位置**: `src/components/ui/Card.tsx`

**依赖关系**:
- **直接依赖**: 
  - `React.forwardRef` - React核心
  - `cn` - 来自 `@/lib/utils`
- **使用工具函数**: 
  - `cn()` - 类名合并
- **使用常量**: 无
- **测试文件**: 规划中
- **Storybook**: 规划中

**Props接口**:
```typescript
interface CardProps {
  variant?: 'default' | 'outlined' | 'elevated';
  clickable?: boolean;
  hover?: boolean;
  children: React.ReactNode;
  className?: string;
  onClick?: () => void;
}
```

**功能特点**:
- 多种样式变体
- 可点击状态
- 悬停效果
- 子组件支持 (CardHeader, CardTitle, CardDescription, CardContent, CardFooter)
- 高度可复用

### 4. **Badge 组件** ✅
**文件位置**: `src/components/ui/Badge.tsx`

**依赖关系**:
- **直接依赖**: 
  - `React` - React核心
  - `cn` - 来自 `@/lib/utils`
- **使用工具函数**: 
  - `cn()` - 类名合并
- **使用常量**: 无
- **测试文件**: 规划中
- **Storybook**: 规划中

**Props接口**:
```typescript
interface BadgeProps {
  variant?: 'default' | 'secondary' | 'destructive' | 'outline';
  size?: 'sm' | 'default' | 'lg';
  children: React.ReactNode;
  className?: string;
}
```

**功能特点**:
- 多种颜色变体 (default, secondary, destructive, outline)
- 多种尺寸 (sm, default, lg)
- 标签显示
- 高度可复用

### 5. **Separator 组件** ✅
**文件位置**: `src/components/ui/Separator.tsx`

**依赖关系**:
- **直接依赖**: 
  - `React` - React核心
  - `cn` - 来自 `@/lib/utils`
- **使用工具函数**: 
  - `cn()` - 类名合并
- **使用常量**: 无
- **测试文件**: 规划中
- **Storybook**: 规划中

**Props接口**:
```typescript
interface SeparatorProps {
  orientation?: 'horizontal' | 'vertical';
  className?: string;
}
```

**功能特点**:
- 水平/垂直方向
- 简单分割线
- 高度可复用

## 🏗️ 布局组件详细记录

### 1. **Container 组件** ✅
**文件位置**: `src/components/layout/Container.tsx`

**依赖关系**:
- **直接依赖**: 
  - `React` - React核心
  - `cn` - 来自 `@/lib/utils`
- **使用工具函数**: 
  - `cn()` - 类名合并
- **使用常量**: 无
- **测试文件**: 规划中
- **Storybook**: 规划中

**Props接口**:
```typescript
interface ContainerProps {
  size?: 'sm' | 'md' | 'lg' | 'xl' | 'full';
  children: React.ReactNode;
  className?: string;
}
```

**功能特点**:
- 响应式容器 (sm: max-w-2xl, md: max-w-4xl, lg: max-w-7xl, xl: max-w-8xl, full: max-w-none)
- 自动居中布局
- 响应式内边距
- 中等可复用

### 2. **Grid 组件** ✅
**文件位置**: `src/components/layout/Grid.tsx`

**依赖关系**:
- **直接依赖**: 
  - `React` - React核心
  - `cn` - 来自 `@/lib/utils`
- **使用工具函数**: 
  - `cn()` - 类名合并
- **使用常量**: 无
- **测试文件**: 规划中
- **Storybook**: 规划中

**Props接口**:
```typescript
interface GridProps {
  cols?: 1 | 2 | 3 | 4 | 5 | 6;
  gap?: 'sm' | 'md' | 'lg';
  children: React.ReactNode;
  className?: string;
}
```

**功能特点**:
- 响应式网格 (1-6列)
- 多种间距 (sm: gap-4, md: gap-6, lg: gap-8)
- 自动响应式列数
- 中等可复用

### 3. **Stack 组件** ✅
**文件位置**: `src/components/layout/Stack.tsx`

**依赖关系**:
- **直接依赖**: 
  - `React` - React核心
  - `cn` - 来自 `@/lib/utils`
- **使用工具函数**: 
  - `cn()` - 类名合并
- **使用常量**: 无
- **测试文件**: 规划中
- **Storybook**: 规划中

**Props接口**:
```typescript
interface StackProps {
  direction?: 'horizontal' | 'vertical';
  spacing?: 'sm' | 'md' | 'lg';
  align?: 'start' | 'center' | 'end' | 'stretch';
  children: React.ReactNode;
  className?: string;
}
```

**功能特点**:
- 水平/垂直堆叠
- 多种间距 (sm: space-2, md: space-4, lg: space-6)
- 多种对齐方式 (start, center, end, stretch)
- 中等可复用

### 4. **Navigation 组件** ✅
**文件位置**: `src/components/layout/Navigation.tsx`

**依赖关系**:
- **直接依赖**: 
  - `Link` - 来自 `next/link`
  - `Button` - 来自 `@/components/ui/Button`
  - `MegaMenu` - 来自 `@/components/layout/MegaMenu`
  - `cn` - 来自 `@/lib/utils`
- **使用工具函数**: 
  - `cn()` - 类名合并
- **使用常量**: 
  - `SITE_CONFIG` - 来自 `@/lib/constants`
- **测试文件**: 规划中
- **Storybook**: 规划中

**功能特点**:
- 桌面端超级菜单
- 移动端汉堡菜单
- 解决方案导航集成超级菜单
- 语言切换器
- 搜索功能
- 状态管理：菜单展开/收起

### 5. **MegaMenu 组件** ✅
**文件位置**: `src/components/layout/MegaMenu.tsx`

**依赖关系**:
- **直接依赖**: 
  - `Link` - 来自 `next/link`
  - `Button` - 来自 `@/components/ui/Button`
  - `cn` - 来自 `@/lib/utils`
- **使用工具函数**: 
  - `cn()` - 类名合并
- **使用常量**: 无
- **测试文件**: 规划中
- **Storybook**: 规划中

**功能特点**:
- 三栏布局的超级菜单
- 桌面端：鼠标悬停展开
- 移动端：点击展开折叠式列表
- 响应式设计
- 支持 isMobile 属性切换显示模式

## 📝 内容组件详细记录

### 1. **BlogCard 组件** ✅
**文件位置**: `src/components/content/BlogCard.tsx`

**依赖关系**:
- **直接依赖**: 
  - `Link` - 来自 `next/link`
  - `Card` - 来自 `@/components/ui/Card`
  - `Badge` - 来自 `@/components/ui/Badge`
  - `cn` - 来自 `@/lib/utils`
- **使用工具函数**: 
  - `cn()` - 类名合并
- **使用常量**: 无
- **测试文件**: 规划中
- **Storybook**: 规划中

**Props接口**:
```typescript
interface BlogCardProps {
  title: string;
  excerpt: string;
  category: string;
  readTime: string;
  href: string;
  image?: string;
  variant?: 'default' | 'featured';
  className?: string;
}
```

**功能特点**:
- 博客文章展示
- 多种显示模式 (default, featured)
- 分类和阅读时间显示
- 悬停效果
- 中等可复用

### 2. **CaseStudyCard 组件** ✅
**文件位置**: `src/components/content/CaseStudyCard.tsx`

**依赖关系**:
- **直接依赖**: 
  - `Link` - 来自 `next/link`
  - `Card` - 来自 `@/components/ui/Card`
  - `Badge` - 来自 `@/components/ui/Badge`
  - `Button` - 来自 `@/components/ui/Button`
  - `cn` - 来自 `@/lib/utils`
- **使用工具函数**: 
  - `cn()` - 类名合并
- **使用常量**: 无
- **测试文件**: 规划中
- **Storybook**: 规划中

**Props接口**:
```typescript
interface CaseStudyCardProps {
  title: string;
  company: string;
  industry: string;
  challenge: string;
  solution: string;
  results: string[];
  href: string;
  variant?: 'preview' | 'full';
  className?: string;
}
```

**功能特点**:
- 案例研究展示
- 多种显示模式 (preview, full)
- 结构化内容 (挑战、解决方案、成果)
- 悬停效果
- 中等可复用

## 🔧 业务组件详细记录

### 1. **ContactForm 组件** ✅
**文件位置**: `src/components/business/ContactForm.tsx`

**依赖关系**:
- **直接依赖**: 
  - `Card` - 来自 `@/components/ui/Card`
  - `Button` - 来自 `@/components/ui/Button`
  - `Input` - 来自 `@/components/ui/Input`
  - `cn` - 来自 `@/lib/utils`
- **使用工具函数**: 
  - `cn()` - 类名合并
- **使用常量**: 无
- **测试文件**: 规划中
- **Storybook**: 规划中

**Props接口**:
```typescript
interface ContactFormProps {
  defaultSubject?: string;
  variant?: 'full' | 'simple';
  className?: string;
}
```

**功能特点**:
- 联系表单收集
- 多种变体 (full, simple)
- 表单验证
- 状态管理
- 低可复用 (业务特定)

### 2. **SolutionPackageCard 组件** ✅
**文件位置**: `src/components/business/SolutionPackageCard.tsx`

**依赖关系**:
- **直接依赖**: 
  - `Link` - 来自 `next/link`
  - `Card` - 来自 `@/components/ui/Card`
  - `Button` - 来自 `@/components/ui/Button`
  - `Badge` - 来自 `@/components/ui/Badge`
  - `cn` - 来自 `@/lib/utils`
- **使用工具函数**: 
  - `cn()` - 类名合并
- **使用常量**: 无
- **测试文件**: 规划中
- **Storybook**: 规划中

**Props接口**:
```typescript
interface SolutionPackageCardProps {
  title: string;
  description: string;
  services: string[];
  href: string;
  className?: string;
}
```

**功能特点**:
- 解决方案包展示
- 服务列表显示
- 悬停效果
- 低可复用 (业务特定)

## 📦 第三方依赖详细记录

### 生产依赖 (Production Dependencies)

#### Next.js 生态系统
| 包名 | 版本 | 用途 | 使用位置 | 备注 |
|------|------|------|----------|------|
| `next` | 15.5.3 | React框架 | 全项目 | 核心框架，提供SSR/SSG |
| `react` | 19.1.0 | UI库 | 全项目 | React核心库 |
| `react-dom` | 19.1.0 | DOM渲染 | 全项目 | React DOM渲染器 |

#### 样式和UI
| 包名 | 版本 | 用途 | 使用位置 | 备注 |
|------|------|------|----------|------|
| `tailwindcss` | ^4 | CSS框架 | 全项目 | 原子化CSS框架 |
| `@tailwindcss/postcss` | ^4 | PostCSS插件 | 全项目 | Tailwind CSS处理 |
| `clsx` | ^2.0.0 | 类名合并 | src/lib/utils.ts | 条件类名处理 |
| `tailwind-merge` | ^2.0.0 | 类名冲突解决 | src/lib/utils.ts | Tailwind类名优化 |

#### 内容管理
| 包名 | 版本 | 用途 | 使用位置 | 备注 |
|------|------|------|----------|------|
| `gray-matter` | ^4.0.3 | Frontmatter解析 | 规划中 | Markdown元数据解析 |
| `remark` | ^15.0.1 | Markdown处理 | 规划中 | Markdown解析器 |
| `remark-html` | ^16.0.1 | HTML转换 | 规划中 | Markdown转HTML |

#### 国际化
| 包名 | 版本 | 用途 | 使用位置 | 备注 |
|------|------|------|----------|------|
| `next-intl` | ^3.0.0 | 国际化 | 规划中 | 多语言支持 |

### 开发依赖 (Development Dependencies)

#### 代码质量
| 包名 | 版本 | 用途 | 使用位置 | 备注 |
|------|------|------|----------|------|
| `typescript` | ^5.9.2 | 类型系统 | 全项目 | TypeScript编译器 |
| `eslint` | ^9 | 代码检查 | 全项目 | JavaScript/TypeScript检查 |
| `eslint-config-next` | 15.5.3 | Next.js ESLint配置 | 全项目 | Next.js专用规则 |
| `eslint-plugin-jsx-a11y` | ^6.8.0 | 可访问性检查 | 全项目 | JSX可访问性规则 |
| `prettier` | ^3.0.0 | 代码格式化 | 全项目 | 代码格式化工具 |

#### 测试
| 包名 | 版本 | 用途 | 使用位置 | 备注 |
|------|------|------|----------|------|
| `jest` | ^29.0.0 | 测试框架 | 全项目 | JavaScript测试框架 |
| `@testing-library/react` | ^14.0.0 | React测试工具 | src/components/__tests__ | React组件测试 |
| `@testing-library/jest-dom` | ^6.0.0 | Jest DOM匹配器 | jest.setup.js | DOM测试增强 |
| `jest-environment-jsdom` | ^29.0.0 | JSDOM环境 | jest.config.js | 浏览器环境模拟 |
| `@types/jest` | ^29.0.0 | Jest类型定义 | 全项目 | TypeScript支持 |

## 🎯 组件使用最佳实践

### 1. **组合使用**
```tsx
// 好的做法：组合简单组件
<Container>
  <Grid cols={3} gap="md">
    <Card>
      <Badge variant="secondary">分类</Badge>
      <h3>标题</h3>
      <p>内容</p>
      <Button>操作</Button>
    </Card>
  </Grid>
</Container>
```

### 2. **避免过度抽象**
```tsx
// 避免：过度抽象的组件
<ComplexCard 
  type="blog"
  showImage={true}
  showCategory={true}
  showReadTime={true}
  showExcerpt={true}
  variant="featured"
  size="large"
  // ... 太多props
/>

// 好的做法：简单明确的组件
<BlogCard 
  title="标题"
  excerpt="摘要"
  category="分类"
  readTime="5分钟"
  href="/blog/slug"
/>
```

### 3. **保持简单**
```tsx
// 好的做法：简单明确的组件
<BlogCard 
  title="标题"
  excerpt="摘要"
  category="分类"
  readTime="5分钟"
  href="/blog/slug"
/>
```

## 📋 开发检查清单

### 新增UI轮子组件时：
- [ ] 设计清晰的Props接口
- [ ] 实现多种变体样式
- [ ] 支持响应式设计
- [ ] 添加无障碍支持
- [ ] 编写单元测试
- [ ] 更新Storybook
- [ ] 编写使用文档

### 新增业务组件时：
- [ ] 基于UI轮子组件构建
- [ ] 保持业务逻辑简单
- [ ] 支持多种使用场景
- [ ] 编写使用示例
- [ ] 更新相关文档

## 🔍 依赖管理最佳实践

### 1. 新增依赖时
- [ ] 评估依赖的必要性
- [ ] 检查版本兼容性
- [ ] 更新package.json
- [ ] 记录使用位置和用途
- [ ] 更新本文档
- [ ] 运行 `npm audit` 检查安全漏洞

### 2. 移除依赖时
- [ ] 确认没有组件在使用
- [ ] 从package.json中移除
- [ ] 更新本文档
- [ ] 测试确保没有破坏性更改

### 3. 更新依赖时
- [ ] 检查更新日志
- [ ] 测试兼容性
- [ ] 更新版本号
- [ ] 更新本文档
- [ ] 运行测试确保功能正常

---

**文档版本**: v3.0.0  
**最后更新**: 2024年1月  
**维护者**: 开发团队  
**项目**: GoChinaAdvisors (仮)
